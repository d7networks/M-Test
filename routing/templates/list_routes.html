{% extends 'dashboard/base.html' %}
{% load static %}

{% block title %}Partner List{% endblock %}

{% block content %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<link rel="stylesheet" href="{% static 'css/routing.css' %}">

<div class="container-fluid mb-5">
    <form class="row justify-content-center" action="{% url 'routing:RouteListView' %}", method="POST">
        <div class="col-2"></div>
        <div class="routing-select col-4 mb-5">
            {% csrf_token %}
            <select id="parner" name="partner" class="form-select" aria-label="Select Partner" onchange="this.form.submit()">
                {% if not partner_id %}
                <option  selected value="">Chose partner</option>
                {% for partner in partners %}
                    <option value="{{partner.id}}">{{ partner.company_name }}</option>
                {% endfor %}
                {% else %}
                {% for partner in partners %}
                {% if partner_id == partner.id %}
                    <option selected value="{{partner.id}}">{{ partner.company_name }}</option>
                {% else %}
                    <option value="{{partner.id}}">{{ partner.company_name }}</option>
                {% endif %}
                {% endfor %}
                {% endif %}
            </select>
        </div>
        <div class="col-4">
            {% csrf_token %}
            <select name="client" class="form-select" aria-label="Select Client" onchange="this.form.submit()">
                <option value="">Choose Client</option>
                {% for client in clients %}
                    {% if client_id == client.id %}
                        <option selected value="{{client.id}}">{{ client.name }}</option>
                    {% else %}
                        <option value="{{client.id}}">{{ client.name }}</option>
                    {% endif %}
                {% endfor %}
            </select>
        </div>
        <div class="col-2"></div>
    </form>
    <div class="col-12 d-flex justify-content-around">
        <form method="POST" action="{% url 'routing:ReloadInstance' %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-primary">Reload Instances</button>
        </form>
        <form action="{% url 'routing:AddRoutingView' %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-primary">Add Routing</button>
        </form>
    </div>
</div>
<div class="container-fluid">
    <table class="table">
  <thead>
    <tr>
      <th scope="col">Country</th>
      <th scope="col">Network</th>
      <th scope="col">Percentage</th>
    </tr>
  </thead>
  <tbody>
    {% for route in routings %}
    <tr>
      <td>{{ route.network.country.name }}</td>
      <td>{{ route.network.name }}</td>
      <td>{{ route.ratio }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
</div>
{% endblock %}